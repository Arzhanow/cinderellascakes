## Ръководство за възстановяване на 3D portfolio страницата

Този файл описва стъпка по стъпка как да пресъздадеш текущата Product Details сцена – трислойно storytelling portfolio с плавен скрол и 3D модел **garash.glb**.

### 1. Основна идея и цели
- Hero + 3 панела, всеки запълва височината на изгледа и разказва част от легендата.
- 3D моделът остава фиксиран в цял екран зад съдържанието и следва движенията на скрола (ляво → дясно → ляво).
- Скрол барът е скрит, а преливането между панелите е супер плавно, без рязка смяна или скачащи стойности.

### 2. Структура на страницата
1. Създай страница `src/pages/ProductDetails.jsx`, която:
   - Чете `productSlug` от URL и взима съответната легенда от `productStories`.
   - Изчислява `scrollYProgress` чрез `useScroll`, подава го към `useSpring` за инерция и го споделя с панелите и 3D сцената.
2. Свят от секции:
   - `<header>` за интрото (височина = `calc(100vh - topbar - navigation)`).
   - `LegendPanel` компоненти (по една секция на история).
   - Финален CTA блок с линк „Назад към продуктите“.

### 3. 3D сцена и канва
- Използвай `@react-three/fiber` + `@react-three/drei`.
- `LegendCanvas`:
  - `<Canvas camera={{ position: [0.2, 1.75, 2.85], fov: 31 }} dpr={[1, 2]}>`.
  - Две `directionalLight` + `ambientLight`.
  - `ContactShadows` с по-голям `scale` (≈7) и `blur`≈2.5.
- `AnimatedGarash`:
  - Зарежда `garash.glb` през `useGLTF` и го клонира с `useMemo`.
  - Интерполира X-позицията чрез `useMotionValueEvent` + `useFrame` (lerp с `delta * 6`) и върти модела с `delta * 0.22`.
- Постави канвата fixed зад съдържанието и добави `.scene-veil`, за да гарантираш контраст при различни теми.

### 4. Scroll storytelling
- `useScroll({ target: containerRef, offset: ['start start', 'end end'] })`.
- Прекарай резултата през `useSpring({ stiffness: 90, damping: 24, mass: 0.5 })` за smooth движение.
- Панелите използват `useTransform` върху прогреса:
  - Opacity: `[start, mid, end] → [0.65, 1, 0.72]`.
  - TranslateY: `[start, mid, end] → [55, 0, -55]`.
- Скрий скрол бара, като добавиш клас `hide-scrollbar` към `body`/`html` при mount и го премахнеш при unmount.

### 5. Теми и визуален контраст
- В `src/styles/base.css` дефинирай допълнителни CSS променливи за всяка тема:
  - `--scene-veil-color`, `--panel-glass-rgb`, `--panel-glass-highlight`, `--panel-glass-stroke`.
- Създай глобални класове:
  - `.scene-veil` – полупрозрачен слой над канвата.
  - `.story-panel` – стъклен панел с градиент, blur и highlight, който пази контраста независимо от цветовата тема.
- Маркирай страницата с `data-surface="dark"` за да работят вече дефинираните типографски цветове.

### 6. Анимационни практики
- Използвай easing `[0.21, 0.47, 0.32, 0.98]` за hero анимациите (съвпадение с останалия сайт).
- `motion.section` с `style={{ opacity, y }}` вместо промяна на display – така панелите никога не изчезват напълно и текстът остава четим.
- `scrollBehavior: 'smooth'` на `<main>` за да избегнеш резки скокове, когато има навигация към anchors (ако добавиш меню).

### 7. Финални проверки
1. `npm run build` – гарантира, че Vite успява да tree-shake и бандълът няма грешки.
2. Тествай с трите теми (`midnight`, `rose`, `peach`) през `ThemeContext`.
3. Проверка на различни резолюции (мобилно, таблет, 2K+) – панелите имат `max-w-2xl`, а отстоянията са с `px-4/10/20`, за да не преливат.
4. Увери се, че линковете към продукта (`/products/:productSlug`) и CTA бутонът работят.

Следвай горните стъпки и ще можеш да изграждаш или пренасяш storytelling портфолиото с 3D модел на всякакъв нов проект.
