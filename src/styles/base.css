@layer base {
  :root {
    --topbar-height: 64px;
    --navigation-height: 0px;
    --anchor-padding: 16px;
    --color-brand-night: 5 1 10;
    --color-brand-dusk: 10 8 20;
    --color-brand-blush: 255 176 247;
    --color-brand-lilac: 189 147 249;
    --color-brand-accent: 255 121 198;
    --color-brand-cyan: 139 233 253;
    --theme-foreground: 255 255 255;
    --theme-border-color: 255 255 255;
    --hero-gradient-start: rgba(5, 1, 10, 0.85);
    --hero-gradient-end: rgba(5, 1, 10, 0.35);
    --hero-overlay: rgba(5, 1, 10, 0.7);
    --theme-button-contrast: 5 1 10;
    --theme-input-bg: rgba(255, 255, 255, 0.08);
    --theme-input-border: rgba(255, 255, 255, 0.35);
    --theme-placeholder: rgba(255, 255, 255, 0.6);
    --shell-max-width: 1240px;
    --shell-padding-inline: clamp(1.5rem, 4vw, 3.5rem);
    --scene-veil-color: rgba(5, 1, 10, 0.85);
    --panel-glass-rgb: 8 5 20;
    --panel-glass-highlight: rgba(255, 190, 244, 0.25);
    --panel-glass-stroke: rgba(255, 255, 255, 0.15);
  }

  @media (max-width: 767px) {
    :root {
      --topbar-height: 0px;
    }
  }

  @media (min-width: 1536px) {
    :root {
      --shell-max-width: 1500px;
      --shell-padding-inline: clamp(1.75rem, 3vw, 4rem);
    }
  }

  @media (min-width: 1920px) {
    :root {
      --shell-max-width: 1800px;
      --shell-padding-inline: clamp(2.25rem, 2.2vw, 5.5rem);
    }
  }

  @media (min-width: 2560px) {
    :root {
      --shell-max-width: 2200px;
      --shell-padding-inline: clamp(2.5rem, 1.8vw, 7rem);
    }
  }

  [data-theme='rose'] {
    --color-brand-night: 244 214 226;
    --color-brand-dusk: 232 188 210;
    --color-brand-blush: 255 170 205;
    --color-brand-lilac: 224 160 245;
    --color-brand-accent: 248 110 152;
    --color-brand-cyan: 177 127 180;
    --theme-foreground: 47 31 41;
    --theme-border-color: 47 31 41;
    --hero-gradient-start: rgba(47, 31, 41, 0.9);
    --hero-gradient-end: rgba(47, 31, 41, 0.45);
    --hero-overlay: rgba(47, 31, 41, 0.82);
    --theme-button-contrast: 47 31 41;
    --theme-input-bg: rgba(255, 230, 242, 0.9);
    --theme-input-border: rgba(47, 31, 41, 0.35);
    --theme-placeholder: rgba(47, 31, 41, 0.5);
    --scene-veil-color: rgba(34, 16, 30, 0.9);
    --panel-glass-rgb: 34 16 30;
    --panel-glass-highlight: rgba(255, 192, 215, 0.35);
    --panel-glass-stroke: rgba(255, 255, 255, 0.22);
  }

  [data-theme='peach'] {
    --color-brand-night: 248 232 212;
    --color-brand-dusk: 234 200 172;
    --color-brand-blush: 255 195 150;
    --color-brand-lilac: 255 210 170;
    --color-brand-accent: 250 135 105;
    --color-brand-cyan: 196 145 114;
    --theme-foreground: 58 34 22;
    --theme-border-color: 58 34 22;
    --hero-gradient-start: rgba(58, 34, 22, 0.9);
    --hero-gradient-end: rgba(58, 34, 22, 0.45);
    --hero-overlay: rgba(58, 34, 22, 0.82);
    --theme-button-contrast: 58 34 22;
    --theme-input-bg: rgba(255, 225, 205, 0.9);
    --theme-input-border: rgba(58, 34, 22, 0.35);
    --theme-placeholder: rgba(58, 34, 22, 0.5);
    --scene-veil-color: rgba(40, 22, 14, 0.9);
    --panel-glass-rgb: 40 22 14;
    --panel-glass-highlight: rgba(255, 205, 170, 0.32);
    --panel-glass-stroke: rgba(255, 255, 255, 0.2);
  }

  html {
    width: 100%;
    overflow-x: hidden;
  }

  body {
    @apply min-h-screen font-sans antialiased;
    background-color: rgb(var(--color-brand-night) / 1);
    color: rgb(var(--theme-foreground) / 1);
    width: 100%;
    overflow-x: hidden;
  }

  .hide-scrollbar {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }

  .scene-veil {
    background: var(--scene-veil-color);
    mix-blend-mode: multiply;
    opacity: 0.95;
    pointer-events: none;
  }

  .story-panel {
    position: relative;
    overflow: hidden;
    border-radius: 2.75rem;
    border: 1px solid var(--panel-glass-stroke, rgba(255, 255, 255, 0.18));
    background-image: linear-gradient(
      135deg,
      rgb(var(--panel-glass-rgb, 5 1 10) / 0.95) 0%,
      rgb(var(--panel-glass-rgb, 5 1 10) / 0.72) 65%
    );
    box-shadow: 0 45px 85px rgba(5, 5, 20, 0.6);
    backdrop-filter: blur(24px);
  }

  .story-panel::before {
    content: '';
    position: absolute;
    inset: 1px;
    border-radius: inherit;
    background: linear-gradient(120deg, var(--panel-glass-highlight, rgba(255, 255, 255, 0.12)), transparent 65%);
    opacity: 0.8;
    pointer-events: none;
  }

  .story-panel > * {
    position: relative;
    z-index: 1;
  }

  section[id] {
    scroll-margin-top: calc(var(--topbar-height) + var(--navigation-height) + var(--anchor-padding));
  }

  .layout-shell {
    width: min(100%, var(--shell-max-width));
    max-width: var(--shell-max-width);
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--shell-padding-inline);
    padding-right: var(--shell-padding-inline);
  }

  #root {
    @apply min-h-screen;
    width: 100%;
    overflow-x: hidden;
  }

  .text-white {
    color: rgb(var(--theme-foreground) / 1) !important;
  }

  .text-white\/85 {
    color: rgb(var(--theme-foreground) / 0.85) !important;
  }

  .text-white\/80 {
    color: rgb(var(--theme-foreground) / 0.8) !important;
  }

  .text-white\/75 {
    color: rgb(var(--theme-foreground) / 0.75) !important;
  }

  .text-white\/70 {
    color: rgb(var(--theme-foreground) / 0.7) !important;
  }

  .text-white\/60 {
    color: rgb(var(--theme-foreground) / 0.6) !important;
  }

  .text-white\/50 {
    color: rgb(var(--theme-foreground) / 0.5) !important;
  }

  .text-white\/40 {
    color: rgb(var(--theme-foreground) / 0.4) !important;
  }

  [data-surface='dark'] .text-white {
    color: rgb(255 255 255 / 1) !important;
  }

  [data-surface='dark'] .text-white\/85 {
    color: rgb(255 255 255 / 0.85) !important;
  }

  [data-surface='dark'] .text-white\/80 {
    color: rgb(255 255 255 / 0.8) !important;
  }

  [data-surface='dark'] .text-white\/70 {
    color: rgb(255 255 255 / 0.7) !important;
  }

  [data-surface='dark'] .text-white\/60 {
    color: rgb(255 255 255 / 0.6) !important;
  }

  [data-surface='dark'] .text-white\/50 {
    color: rgb(255 255 255 / 0.5) !important;
  }

  [data-surface='dark'] .text-white\/40 {
    color: rgb(255 255 255 / 0.4) !important;
  }

  .text-button-contrast {
    color: rgb(var(--theme-button-contrast) / 1) !important;
  }

  .theme-input {
    background-color: var(--theme-input-bg) !important;
    border-color: var(--theme-input-border) !important;
    color: rgb(var(--theme-button-contrast) / 1) !important;
    font-size: clamp(1rem, 0.95rem + 0.2vw, 1.2rem);
    line-height: 1.6;
  }

  .theme-input::placeholder {
    color: var(--theme-placeholder);
  }

  .theme-input:focus {
    border-color: rgb(var(--theme-border-color) / 0.8) !important;
    outline: none;
    box-shadow: 0 0 0 2px rgb(var(--theme-border-color) / 0.25);
  }

  .theme-chip {
    background-color: var(--theme-input-bg) !important;
    border-color: var(--theme-input-border) !important;
    color: rgb(var(--theme-button-contrast) / 1) !important;
    font-size: clamp(0.875rem, 0.8rem + 0.25vw, 1.125rem);
  }

  .border-white {
    border-color: rgb(var(--theme-border-color) / 1) !important;
  }

  .border-white\/10 {
    border-color: rgb(var(--theme-border-color) / 0.1) !important;
  }

  .border-white\/15 {
    border-color: rgb(var(--theme-border-color) / 0.15) !important;
  }

  .border-white\/20 {
    border-color: rgb(var(--theme-border-color) / 0.2) !important;
  }

  .border-white\/30 {
    border-color: rgb(var(--theme-border-color) / 0.3) !important;
  }

  .border-white\/40 {
    border-color: rgb(var(--theme-border-color) / 0.4) !important;
  }
}

@layer utilities {
  @keyframes fall-and-fade {
    0% {
      transform: translate3d(
        var(--cake-start-x, 0vw),
        var(--cake-start-y, -10vh),
        0
      )
        scale(var(--cake-scale, 0.6));
      opacity: 0;
    }

    45% {
      transform: translate3d(
        var(--cake-mid-x, 0vw),
        var(--cake-mid-y, 40vh),
        0
      )
        scale(var(--cake-scale, 0.6));
      opacity: 0.85;
    }

    100% {
      transform: translate3d(
        var(--cake-end-x, 0vw),
        var(--cake-end-y, 110vh),
        0
      )
        scale(var(--cake-scale, 0.6));
      opacity: 0;
    }
  }

  @keyframes slow-spin {
    0% {
      rotate: var(--cake-rotation-start, -8deg);
    }

    100% {
      rotate: var(--cake-rotation-end, 8deg);
    }
  }

  .animate-fall-and-fade {
    animation-name: fall-and-fade, slow-spin;
    animation-timing-function: linear, ease-in-out;
    animation-iteration-count: infinite, infinite;
    animation-fill-mode: both, both;
    will-change: transform, opacity;
  }
}
